---
title: "R을 이용한 공공데이터 분석_제8장"
output:
  html_document:
    toc: true
    toc_float: true
    keep_md: true
date: '2022-06-23'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

제8장 통계분석
-
# 0단원 자율학습
- @분석을 사용하야된다! -> 선행연구를 찾아보기, 해당 분석 방법의 가설 설정 예시를 확인하기

# 1단원 분석 방법 (172p)
## 1. 기술 통계
- 기술통계 : 평균, 최솟갑스 최댓값, 중간값
- 일반인들은 이정도만 알아도 업무가능.

## 2. 추론 통계
- 변수 간의 관계를 파악 / 새로운 사실을 발견(=추정)

### 2.1. 평균 차이 검정  [핵심]
- =평균분석, 숫자
- 가설 검정 : 평균의 차이를 검정
- ex. 남자의 평균 키와 여자의 평균 키는 차이가 있을 것이다.(핵심키워드: 평균, 그룹_남/녀, 차이)

### 2.2. 교차분석
- =빈도분석, 문자열
- 가설검정 : 각 범주별 빈도를 활용해서 관계성을 검정
- ex. 작은 아파트에서의 대형 티비 구매율과 큰 평수 아파트의 대형 티비 구매율 비교

### 2.3. 상관관계분석
- 수치 데이터, 
- 그래프가 1로 수렴 : 양의 상관관계(우상향 그래프)
- 그래프가 -1로 수렴 : 음의 상관관계(우하향 그래프프)
- 그래프가 0으로 수렴 : 두 수치 데이터 간에 상관관계가 없음(그래프가 엉망이면)
- 두 변수간의 상관관계가 있느냐 없느냐?
- ex. 기온에 따라 아이스 아메리카노 판매량을 비교

### 2.4. 회귀분석  [핵심]
- 회귀 분석: 독립변수와 종속변수 간의 인과관계를 분석하는 통계적 방법
- 단순회귀분석: 독립변수가 1석, 다중회귀본석: 독립변수가 2개
- 단순회귀분석: y(종속변수) = a(기울기)x+b(상수항)
- 가설검정 x값이 y값에 영향을 주느냐?
- ex. 기온(독립변수)이 판매량(종속변수)에 [긍정적인/부정적인인]영향을 주고 있을 것이다.


# 2단원 통계 검정 (176p)

## 1. 가설 (hypothesis)
- 귀무가설: 두 집단의 평균 차이가 없다.
- 대립가설: 두 집단의 평균 차이가 있다. (평소 우리가 궁금해 하는 분야)

## 2. 유의수준(反오차범위)
- 유의수준_p-value(p값): 귀무설(평균 차이 X)이 맞는데도 대립가설(평균 차이 O)을 채택할 확률
- 예외가 있을 수는 있으나, 이를 인정해주되(허용할 수 있는 예외 범위) 일반화할 수는 없다.
- 가설 검정에서 인정하는 유의 수준 [5%, 1%, 0.1%, 10%]
- 유의수준의 범위가 넓으면 연구 결과를 얻기 쉽지만 정확성이 떨어짐.
- 유의수준의 범위가 좁으면 연구 결과를 얻기 어렵만 정확성이 높아짐.

## 2.(2) 오차범위
- 오차범위=신뢰수준(confidence level)
- 오차범위 내에 있다 -> 이 설문을 다음에 또 해보면 결과가 다르게 나올 수 있다. 아직까지 차이가 크지 않다.
- 오차범위 밖에 있다 -> 이 설문을 다음에 또 해보면 결과가 똑같게 나온다. 최종결과 굳어짐.

## 3. 척도  [SKIP]
- 척도: 측정도구, 수치로 표시됨.
- 명목척도: 대상의 특성이나 범주 구분, 산술연산 X     ex.성별, 결혼유무, 종교, 인종
- 서열척도: 대상의 등급순위,           산술연산 X     ex.계급, 사회계층, 자격등급
- 등간척도: 대상을 일정 간격으로 구분, 덧셈과 뺄젬 O  ex.온도, 학력, 시험점수
- 비율척도: 대상을 비율로 구분,         4칙연산 O     ex.연령, 무게


# 3단원 통계 분석 사례 (178p)

## 1. 두 집단의 평균 차이 검정
- t.test 어떻게 데이터를 입력하는지 확인
- 결과가 나오면 p-value 확인, 유의수준 0.05이상->귀무가설, 유의수준 0.05이하->대립가설
- 
- t.test(data=데이터세트,종속변수_반응변수_y(비교값)~독립변수_설명변수_x(비교대상))
- t.test(데이터세트$종속변수(비교값)~데이터세트$독립변수(비교대상))
- 
- 등분산 검정: 두 그룹의 평균 차이 검정이전에 사전 필수 검증이 필요하다. 데이터 양이 비슷한가. 조건이 비슷한가. ex.10건 vs 100건 비교할 수 없음.
- 두 그룹간의 분산이 비슷하면 --> t.test(모수검정)
- 두 구룹간의 분산이 다르면 --> 비모수 검정
- 귀무가설: 두 그룹간의 분산이 비슷하다.
- 대립가설: 두 그룹간의 분산이 다르다.
- 등분산 검정에서는 귀무가설을 지지해야 t.test를 사용할 수 있다.
```{r}
mpg1 <-read.csv("data/mpg1.csv",stringsAsFactors = F)
str(mpg1)

# 시각화
library(ggplot2)
ggplot(mpg1,aes(x=trans,y=cty))+
  geom_boxplot()
# 평균값이 크게 차이나는지 확인하기 애매하다

# 때문에 t.test 통계검정을 한다.
# 귀무가설 : auto와 manual의 cty 평균은 차이가 없다.
# 대립가설 : auto와 manual의 cty 평균은 차이가 있다.
t.test(data = mpg1,cty ~ trans)
                  # 종속변수 ~ 독립변수
                  # 반응변수 ~ 설명변수
                  # y          x


# 등분산 검정, 귀무가설이어야 t.test를 사용할 수 있다. p-value 0.05 이상여야함.
var.test(data = mpg1, cty~trans)

# 시각화 방법 1
ggplot(mpg1, aes(x = cty, fill = trans)) + 
  geom_histogram()
  
# 시각화 방법 2
ggplot(mpg1, aes(x = cty, fill = trans)) + 
  geom_density(alpha = 0.1)
```


## 2. 교차분석
- chisq.test() 함수 활용
- 교차분석: 범주형 변수들이 관계가 있다는 것을 입증.
- 평균의 차이가 아니라 '비율에 차이'가 있는지를 검정합니다.
- 교차분석 검정은 R의 chisq.test() 함수로 진행
- 귀무가설 : trans에 따라 drv(4,f,r)의 (비율)차이가 없다.
- 대립가설 : trans에 따라 drv의 차이가 있다. 

```{r}
# 빈도표
table(mpg1$trans,mpg1$drv) # 교차분석

# 비율
prop.table(table(mpg1$trans, mpg1$drv),1)
# 결과- auto 4륜 구동(4)인 47.8%, manual 전륜구동(f) 53.2%가 가장 많음
# 가정- 실제로 통계적으로 봤을 때, 차이가 있는지 검정
# 귀무가설 : trans에 따라 drv(4,f,r)의 (비율)차이가 없다.
# 대립가설 : trans에 따라 drv의 차이가 있다. 

# 방법 1
chisq.test(mpg1$trans,mpg1$drv)

# 방법 2
chisq.test(table(mpg1$trans,mpg1$drv))

# 방법 3
summary(table(mpg1$trans,mpg1$drv))

# p-value를 확인하고 귀무/대립가설인지 확인
# 결과- trans에 따라 drv(4,f,r)의 (비율)차이가 없다.
```

## 3. 상관관계분석
- cor.test() 함수 활용
```{r}
mpg1 <-read.csv("data/mpg1.csv", stringsAsFactors = F)

cor.test(mpg1$cty,mpg1$hwy)  # 상관관계 분석
# 결과 - p-value 가 2.2/10의16승 보다 작다. -> 0.05보다 작음 -> 대립가설 채택, 
# sample estimates: 0.9559159 상관관계가 1에 가까움 -> 상관관계가 높다
```

## 4. 회귀분석
- 06.24 오전 강의
```{r}
```

### 4.1. 단순회귀분석
```{r}

```

### 4.2. 다중회귀분석
```{r}

```

